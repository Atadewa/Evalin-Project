@tailwind base;
@tailwind components;
@tailwind utilities;

@layer base {
  body {
    @apply bg-background text-secondary;
  }
}

@layer components {
  /* Button Components */
  .btn-primary {
    @apply inline-flex items-center px-4 py-2 bg-primary border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-blue-700 focus:bg-blue-700 active:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 transition ease-in-out duration-150;
  }

  .btn-secondary {
    @apply inline-flex items-center px-4 py-2 bg-gray-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-gray-700 focus:bg-gray-700 active:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition ease-in-out duration-150;
  }

  .btn-success {
    @apply inline-flex items-center px-4 py-2 bg-green-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-green-700 focus:bg-green-700 active:bg-green-800 focus:outline-none focus:ring-2 focus:ring-green-500 focus:ring-offset-2 transition ease-in-out duration-150;
  }

  .btn-warning {
    @apply inline-flex items-center px-4 py-2 bg-yellow-500 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-yellow-600 focus:bg-yellow-600 active:bg-yellow-700 focus:outline-none focus:ring-2 focus:ring-yellow-400 focus:ring-offset-2 transition ease-in-out duration-150;
  }

  .btn-danger {
    @apply inline-flex items-center px-4 py-2 bg-red-600 border border-transparent rounded-md font-semibold text-xs text-white uppercase tracking-widest hover:bg-red-700 focus:bg-red-700 active:bg-red-800 focus:outline-none focus:ring-2 focus:ring-red-500 focus:ring-offset-2 transition ease-in-out duration-150;
  }

  .btn-sm {
    @apply px-3 py-1 text-xs;
  }

  /* Card Components */
  .card {
    @apply bg-white overflow-hidden shadow-sm sm:rounded-lg border border-gray-200;
  }

  .card-body {
    @apply p-6;
  }

  .card-title {
    @apply text-lg font-semibold text-secondary mb-4;
  }

  /* Table Components */
  .table {
    @apply w-full text-sm text-left text-gray-500;
  }

  .table thead {
    @apply text-xs text-gray-700 uppercase bg-gray-50;
  }

  .table th {
    @apply px-6 py-3 font-medium text-gray-900 whitespace-nowrap;
  }

  .table td {
    @apply px-6 py-4;
  }

  .table-striped tbody tr:nth-child(odd) {
    @apply bg-white;
  }

  .table-striped tbody tr:nth-child(even) {
    @apply bg-gray-50;
  }

  .table-bordered {
    @apply border border-gray-300;
  }

  .table-bordered th,
  .table-bordered td {
    @apply border-b border-gray-300;
  }

  /* Form Components */
  .form-control {
    @apply block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-primary focus:border-primary sm:text-sm;
  }

  .form-label {
    @apply block text-sm font-medium text-gray-700 mb-2;
  }

  /* Alert Components */
  .alert {
    @apply p-4 mb-4 text-sm rounded-lg;
  }

  .alert-info {
    @apply text-blue-800 bg-blue-50 border border-blue-300;
  }

  .alert-success {
    @apply text-green-800 bg-green-50 border border-green-300;
  }

  .alert-warning {
    @apply text-yellow-800 bg-yellow-50 border border-yellow-300;
  }

  .alert-danger {
    @apply text-red-800 bg-red-50 border border-red-300;
  }

  /* Dashboard Components */
  .dashboard-shell {
    @apply bg-gray-50 min-h-screen py-8;
  }

  .page-container {
    @apply max-w-7xl mx-auto px-6;
  }

  .dashboard-header {
    @apply bg-blue-600 text-white rounded-3xl p-9 flex flex-col lg:flex-row justify-between items-start gap-6 shadow-xl mb-10 relative overflow-hidden;
  }

  .dashboard-header h1 {
    @apply text-3xl font-bold mb-1;
  }

  .dashboard-header p {
    @apply text-blue-100 max-w-lg leading-relaxed;
  }

  .header-actions {
    @apply flex flex-col sm:flex-row items-start sm:items-center gap-3 relative z-10;
  }

  .info-pill {
    @apply bg-white bg-opacity-20 rounded-full px-4 py-2 flex items-center gap-2 text-sm font-medium;
  }

  .primary-btn {
    @apply bg-white text-blue-600 font-semibold px-5 py-2 rounded-full hover:shadow-lg hover:-translate-y-0.5 transition-all duration-200 flex items-center gap-2;
  }

  .section-title {
    @apply text-lg font-semibold text-gray-600 uppercase tracking-wide mb-4;
  }

  .metrics-grid {
    @apply grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-5 gap-6;
  }

  .metric-card {
    @apply bg-white rounded-2xl border border-gray-200 p-6 hover:-translate-y-1 hover:shadow-xl transition-all duration-300 relative overflow-hidden;
  }

  .metric-icon {
    @apply w-11 h-11 bg-blue-100 text-blue-600 rounded-xl inline-flex items-center justify-center text-xl mb-2;
  }

  .metric-card h3 {
    @apply text-sm font-medium text-gray-600 uppercase tracking-wide mb-1;
  }

  .metric-value {
    @apply text-2xl font-bold text-gray-900 mb-1;
  }

  .metric-subtitle {
    @apply text-sm text-gray-500;
  }

  .metric-trend {
    @apply inline-flex items-center gap-1 text-xs font-semibold text-green-600 bg-green-100 px-2 py-1 rounded-full mt-2;
  }

  /* Sidebar Components */
  #sidebar {
    transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    width: 16rem; /* 256px - w-64 default */
    min-width: 16rem; /* Prevent unwanted shrinking */
  }

  /* Sidebar sticky positioning for desktop */
  @media (min-width: 1024px) {
    #sidebar {
      position: sticky !important;
      top: 0 !important;
      height: 100vh !important;
      overflow-y: auto !important;
      scrollbar-width: thin;
      scrollbar-color: #e5e7eb #f9fafb;
    }

    /* Custom scrollbar for webkit browsers */
    #sidebar::-webkit-scrollbar {
      width: 6px;
    }

    #sidebar::-webkit-scrollbar-track {
      background: #f9fafb;
    }

    #sidebar::-webkit-scrollbar-thumb {
      background: #e5e7eb;
      border-radius: 3px;
    }

    #sidebar::-webkit-scrollbar-thumb:hover {
      background: #d1d5db;
    }
  }

  .sidebar-collapsed {
    width: 4rem !important; /* 64px - w-16 forced width */
    min-width: 4rem !important; /* Ensure collapsed width is maintained */
  }

  /* Main wrapper adjustments for sticky sidebar */
  @media (min-width: 1024px) {
    .main-wrapper {
      display: flex;
      min-height: 100vh;
      overflow: hidden;
    }

    .content-wrapper {
      flex: 1;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
      max-height: 100vh;
      overflow: hidden;
    }

    .main-content {
      flex: 1;
      overflow-y: auto;
      max-height: calc(100vh - 70px - 64px); /* Adjust for header and footer */
    }
  }

  /* Hide text elements when collapsed */
  .sidebar-collapsed .sidebar-text {
    display: none;
  }

  .sidebar-collapsed .sidebar-section-title {
    display: none;
  }

  /* Logo adjustments */
  .sidebar-logo {
    transition: all 0.3s ease-in-out;
  }

  .sidebar-collapsed .sidebar-logo {
    width: 2rem;
    height: 2rem;
  }

  /* Icon centering */
  .sidebar-icon {
    transition: margin 0.3s ease-in-out;
  }

  .sidebar-collapsed .sidebar-icon {
    margin-right: 0;
  }

  /* Menu link adjustments */
  .sidebar-collapsed nav a {
    justify-content: center;
    padding-left: 1rem;
    padding-right: 1rem;
  }

  /* Section padding adjustments */
  .sidebar-collapsed nav > div {
    padding-left: 0.5rem;
    padding-right: 0.5rem;
  }

  /* Ensure menu items are still clickable and properly sized */
  .sidebar-collapsed nav a {
    min-height: 48px;
    display: flex;
    align-items: center;
    justify-content: center;
    position: relative;
    margin-bottom: 0.5rem;
  }

  /* Tooltip for collapsed sidebar */
  .sidebar-collapsed nav a {
    position: relative;
  }

  .sidebar-collapsed nav a:hover::before {
    content: attr(title);
    position: absolute;
    left: calc(100% + 0.75rem);
    top: 50%;
    transform: translateY(-50%);
    background: rgba(17, 24, 39, 0.95);
    color: #ffffff;
    padding: 0.5rem 0.75rem;
    border-radius: 0.375rem;
    font-size: 0.75rem;
    font-weight: 500;
    white-space: nowrap;
    z-index: 1000;
    pointer-events: none;
    box-shadow:
      0 10px 15px -3px rgba(0, 0, 0, 0.1),
      0 4px 6px -2px rgba(0, 0, 0, 0.05);
  }

  /* Arrow for tooltip */
  .sidebar-collapsed nav a:hover::after {
    content: "";
    position: absolute;
    left: calc(100% + 0.25rem);
    top: 50%;
    transform: translateY(-50%);
    width: 0;
    height: 0;
    border-top: 0.25rem solid transparent;
    border-bottom: 0.25rem solid transparent;
    border-right: 0.25rem solid rgba(17, 24, 39, 0.95);
    z-index: 1000;
    pointer-events: none;
  }

  /* Modal positioning within content area */
  .swal2-container {
    position: fixed !important;
    z-index: 999 !important;
  }

  /* Desktop modal positioning with sticky sidebar */
  @media (min-width: 1025px) {
    .swal2-container {
      left: 16rem !important; /* Offset for sidebar width */
      top: 0 !important; /* Full height with sticky sidebar */
      width: calc(
        100% - 16rem
      ) !important; /* Adjust width to exclude sidebar */
      height: 100vh !important; /* Full viewport height */
      padding: 0 !important;
    }

    /* Adjust modal for collapsed sidebar */
    .sidebar-collapsed ~ * .swal2-container,
    .sidebar-collapsed ~ .swal2-container {
      left: 4rem !important; /* Collapsed sidebar width */
      width: calc(100% - 4rem) !important;
    }
  }

  /* Mobile modal positioning */
  @media (max-width: 1024px) {
    .swal2-container {
      left: 0 !important;
      width: 100% !important;
      top: 70px !important;
      height: calc(100vh - 70px) !important;
      padding: 0 !important;
    }
  }

  /* Modal popup positioning */
  .swal2-popup {
    position: relative !important;
    top: 50% !important;
    left: 50% !important;
    transform: translate(-50%, -50%) !important;
    margin: 0 !important;
    max-width: 90% !important;
    max-height: 90% !important;
  }

  /* Backdrop within content area */
  .swal2-backdrop-show {
    background: rgba(0, 0, 0, 0.4) !important;
  }

  /* Header Components */
  header {
    position: relative;
    z-index: 40;
  }

  /* Profile dropdown adjustments */
  .profile-dropdown {
    z-index: 9999 !important;
  }

  .profile-dropdown .dropdown-menu {
    position: absolute;
    right: 0;
    top: 100%;
    margin-top: 0.5rem;
    z-index: 9999;
  }

  /* Ensure profile image is always visible */
  .profile-image {
    display: block !important;
    min-width: 2rem;
    min-height: 2rem;
  }

  /* Force profile button and image visibility */
  header button img {
    display: block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  header button span {
    display: inline-block !important;
    visibility: visible !important;
    opacity: 1 !important;
  }

  /* Ensure header dropdown container is always visible */
  header .relative {
    display: block !important;
    visibility: visible !important;
  }

  /* Fix for Alpine.js dropdown positioning */
  [x-cloak] {
    display: none !important;
  }

  /* Ensure dropdown is above all content */
  .header-dropdown {
    position: relative;
    z-index: 50;
  }

  .header-dropdown .dropdown-content {
    position: absolute;
    right: 0;
    margin-top: 0.5rem;
    z-index: 9999;
    min-width: 12rem;
  }
}
